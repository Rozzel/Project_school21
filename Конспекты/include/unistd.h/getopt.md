---
tag:
- C/include/unistd.h
- С/getopt
---

Функция `getopt` в языке программирования Си используется для разбора аргументов командной строки. Это полезно, когда ваша программа принимает различные опции и аргументы, которые могут быть представлены в различном порядке.

Прототип функции `getopt` выглядит так:

```c
#include <unistd.h>

int getopt(int argc, char * const argv[], const char *optstring);
```

Описание аргументов:

- `argc`: количество аргументов, переданных вашей программе. Обычно это первый аргумент функции `main`.
- `argv`: массив строк, представляющих аргументы вашей программы. Обычно это второй аргумент функции `main`.
- `optstring`: строка, содержащая допустимые опции для вашей программы. Если опция требует аргумента, после символа опции следует символ `:`.

`getopt` возвращает следующее:

- Если опция была обнаружена, `getopt` возвращает символ этой опции.
- Если опция требует аргумент, `optarg` (глобальная переменная, объявленная в `unistd.h`) указывает на аргумент.
- Если обнаружена опция, которая не указана в `optstring`, `getopt` возвращает `?`, и `optopt` (еще одна глобальная переменная) содержит символ недопустимой опции.
- Если опции закончились, `getopt` возвращает `-1`.

Вот пример использования `getopt`:

```c
#include <unistd.h>
#include <stdio.h>

int main(int argc, char *argv[]) {
    int opt;
    while((opt = getopt(argc, argv, "a:b:c")) != -1) {
        switch (opt) {
            case 'a':
                printf("option a with value %s\n", optarg);
                break;
            case 'b':
                printf("option b with value %s\n", optarg);
                break;
            case 'c':
                printf("option c with no value\n");
                break;
            case '?':
                printf("unknown option: %c\n", optopt);
                break;
        }
    }
    return 0;
}
```

В этом примере программа принимает опции `-a`, `-b` и `-c`. Опции `-a` и `-b` требуют аргумента (значения после них), а опция `-c` - нет. Если вы запустите эту программу с аргументами `-a 1 -b 2 -c`, она распечатает:

```
option a with value 1
option b with value 2
option c with no value
```

Обратите внимание, что порядок аргументов может быть любым. Например, `-c -a 1 -b 2` также будет работать.


`getopt` и `getopt_long` являются функциями разбора аргументов командной строки в языке программирования Си. Они имеют некоторые отличия в том, как они обрабатывают и распознают опции.
[getopt_long](../getopt.h/getopt_long.md)